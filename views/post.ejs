<%- include('partials/header') -%>
<div class="container">
  <div class="row justify-content-left mt-5">
    <h2><%= post.location %></h2>
    <p class="address"><%= post.address %></p>
    <div class="main-section">
      <div class="details-section">
        <div class="row justify-content-between">
          <div class="img-section">
            <img class="img-fluid" src="<%= post.image%>" />
            <div class="fav-buttons">
              <form
                class="col-1"
                action="/post/likePost/<%= post.id %>?_method=PUT"
                method="POST"
              >
                <button class="btn btn-primary fa fa-heart" type="submit"></button>
                <h3 class="col-3"><%= post.likes %></h3>
              </form>
              <%if(post.user == user.id){ %>
              <form
                action="/post/deletePost/<%= post.id %>?_method=DELETE"
                method="POST"
                class="col-1"
              >
                <button class="btn btn-primary fa fa-trash" type="submit"></button>
              </form>
              <%}%>
            </div>
          </div>
        </div>
        <div>
          <div class="description">
            <div class="details">
              <p class="detail-title">Hours</p>
              <p><%= post.hours %></p>
            </div>
            <div class="details">
              <p class="detail-title">Power Outlets?</p>
              <p><%= post.outlet %></p>
            </div>
            <div class="details">
              <p class="detail-title">Free Wi-Fi?</p>
              <p><%= post.wifi %></p>
            </div>
            <div class="details">
              <p class="detail-title">Bathrooms?</p>
              <p><%= post.bathroom %></p>
            </div>
          </div>
        </div>
      </div>
      
    <div id="map-container"></div>

    <script>
        function updateMap() {
        const mapContainer = document.getElementById('map-container');

        // Get the content of the element with class "address"
        const addressElement = document.querySelector('.address');
        const address = addressElement.textContent.trim();

        // Remove existing iframe if any
        while (mapContainer.firstChild) {
            mapContainer.removeChild(mapContainer.firstChild);
        }

        const iframe = document.createElement('iframe');
        iframe.src = `https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d13205.34352471949!2d-118.28226456044922!3d34.16332919999999!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x80c2c047dbc413c7%3A0x6750e47715aa755b!2s${encodeURIComponent(address)}!5e0!3m2!1sen!2sus!4v1703029225921!5m2!1sen!2sus`;
        iframe.width = '100%';
        iframe.height = '100%';
        iframe.style.border = '0';
        iframe.allowfullscreen = true;
        iframe.loading = 'lazy';
        iframe.referrerpolicy = 'no-referrer-when-downgrade';

        mapContainer.appendChild(iframe);
    }

    // Call the updateMap function
    updateMap();
    </script>

    </div>
    <div class="return-buttons">
      <a class="btn btn-primary" href="/profile">Return to Profile</a>
      <a class="btn btn-primary" href="/feed">Return to Feed</a>
    </div>
  </div>
</div>

<%- include('partials/footer') -%>
